---
layout: note
title: "2025å¹´8æœˆ"
---

## ğŸ—“ï¸ æ¯æ—¥è®°å½•

### 8æœˆ7æ—¥
- é…¸åŒ–é¡¹ç›®ï¼Œå£³åœºç»†èƒå’Œè¡€ç»†èƒåˆ†ç¾¤
```R
library(Seurat)
library(stringr)
library(patchwork)
library(tidyverse)
library(monocle)

load(file="../seob.rdata")

seob <- FindNeighbors(seob, k.param = 20, dims = 1:50)
# Find clusters with different resolutions
seob <- FindClusters(seob, resolution = 0.1, random.seed = 1)
DefaultAssay(seob) <- "RNA"
seob_obj <- subset(seob, idents = c(0,2,4,8,12,14))

subset_obj <- SCTransform(seob_obj, verbose = FALSE)
subset_obj <- RunPCA(subset_obj)
subset_obj <- RunUMAP(subset_obj, dims = 1:30)
subset_obj <- FindNeighbors(subset_obj, dims = 1:30)
subset_obj <- FindClusters(subset_obj, resolution = 0.1)

pdf("subset_obj.pca_tsne_umap.pdf",height=4,width=10)
p1 <- DimPlot(subset_obj, reduction = "pca")
p2 <- DimPlot(subset_obj, reduction = "tsne")
p3 <- DimPlot(subset_obj, reduction = "umap")
p1 + p2 + p3 + plot_layout(guides = "collect") & theme(legend.position = "top")
dev.off()
```
<img width="600" height="240" alt="subset_obj pca_tsne_umap" src="https://github.com/user-attachments/assets/49e364f9-0cf5-413c-91ed-909862e5d945" />

```R
pdf("subset_obj.umap.pdf", height=8, width=8)
DimPlot(subset_obj, reduction = "umap")
dev.off()
```
<img width="400" height="400" alt="subset_obj umap" src="https://github.com/user-attachments/assets/05980aa0-a753-4310-a76c-11d67761af76" />

```R
subset_obj$sample <- factor(subset_obj$sample, levels = c("S74OA", "S74WT", "S81OA", "S81WT", "S74OAOA", "S74OAWT", "S74WTOA", "S74WTWT", "S81OAOA", "S81OAWT", "S81WTOA", "S81WTWT"))
pdf("subset_obj.umap_cluster01BySamples.pdf", width=6, height=6)
DimPlot(subset_obj, reduction = "umap", split.by = "sample", pt.size=0.5, ncol=4)
dev.off()
```
<img width="450" height="450" alt="subset_obj umap_cluster01BySamples" src="https://github.com/user-attachments/assets/c7d0808b-a714-453a-9b8d-252857399f06" />

```R
# Use FindAllMarkers to find markers for all clusters
markers <- FindAllMarkers(subset_obj, 
                          only.pos = TRUE,   # Only return markers that are positively expressed
                          min.pct = 0.25,    # Minimum percentage of cells expressing the gene
                          logfc.threshold = 0.25)  # Minimum log fold change to consider a gene as a marker

# View the top markers for each cluster
head(markers)
write.table(markers, "subset_obj.markers.txt", row.names=F, col.names=TRUE, sep="\t", quote=F)

DefaultAssay(subset_obj) <- "integrated"
# Select the top 10 genes per cluster based on average log fold change
top20 <- markers %>%
  group_by(cluster) %>%
  top_n(n = 20, wt = avg_log2FC)

pdf("subset_obj.heatmap.pdf")
# Generate the heatmap
DoHeatmap(subset_obj, features = top20$gene, group.by = "seurat_clusters") +
  scale_fill_gradientn(colors = c("blue", "white", "red")) +
  theme(
    axis.text.y = element_blank(), # Remove y-axis text
    axis.text.x = element_blank(), # Remove x-axis text
    axis.title.y = element_blank(), # Remove y-axis label
    axis.title.x = element_blank()  # Remove x-axis label
  )
dev.off()
```
<img width="500" height="500" alt="subset_obj heatmap" src="https://github.com/user-attachments/assets/7fa0053b-0bf1-47fb-96fb-525f1405e692" />


### 8æœˆ8æ—¥
- è®°å½• acidification å®éªŒ pH æ³¢åŠ¨
- åˆæ­¥æŸ¥çœ‹ survival ç»“æœ

...ï¼ˆæŒç»­è¿½åŠ æ¯å¤©ï¼‰
